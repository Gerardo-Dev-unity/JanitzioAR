<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Test Cámara (getUserMedia)</title>
<style>
  html,body{margin:0;height:100%;background:#000;color:#0f0;font:14px/1.4 system-ui}
  #ui{position:fixed;inset:0;display:flex;flex-direction:column;gap:12px;align-items:center;justify-content:center}
  video{width:100%;max-width:480px;background:#222}
  button{padding:10px 16px;border:0;border-radius:10px;background:#16a34a;color:#fff;font-weight:700}
  #log{position:fixed;left:8px;bottom:8px;background:#111;padding:8px;border-radius:8px;max-width:95vw;word-break:break-word}
</style>
</head>
<body>
<div id="ui">
  <button id="btn">Tocar para activar cámara</button>
  <video id="v" playsinline autoplay muted></video>
</div>
<div id="log">Log…</div>
<script>
const v = document.getElementById('v');
const logBox = document.getElementById('log');
const log = m => { console.log(m); logBox.textContent = m; };

document.getElementById('btn').addEventListener('click', async () => {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: { ideal: "environment" } }, audio: false
    });
    v.srcObject = stream;
    v.onloadedmetadata = () => { v.play().catch(()=>{}); log('✅ Cámara OK (metadata cargada)'); };
    v.oncanplay = () => log('✅ canplay (hay frames)');
  } catch(e) {
    log('❌ getUserMedia error: ' + e.name + ' — ' + e.message);
  }
});
</script>
</body>
</html>
